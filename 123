-- Normalized and readable version of the script
-- Preserving all functionality

local fenv = getfenv()
local Players = game:GetService('Players')
local ReplicatedStorage = game:GetService('ReplicatedStorage')
local RunService = game:GetService('RunService')
local UserInputService = game:GetService('UserInputService')
local TweenService = game:GetService('TweenService')
local HttpService = game:GetService('HttpService')
local Chat = game:GetService('Chat')

setthreadidentity(2)

_G.fakePlayerIds = {}

-- Override SettingsHelper
task.spawn(function()
    task.wait(0.1)
    
    local SettingsHelper = require(ReplicatedStorage:WaitForChild('Fsys')).load('SettingsHelper')
    local originalGetSetting = SettingsHelper.get_setting_server
    
    SettingsHelper.get_setting_server = function(...)
        local args = ...
        local userId = args.UserId
        
        Players:GetPlayerByUserId(userId)
        
        local result = originalGetSetting(...)
        return result
    end
end)

-- Override FamilyHelper functions
task.spawn(function()
    task.wait(0.1)
    
    local FamilyHelper = require(ReplicatedStorage:WaitForChild('Fsys')).load('FamilyHelper')
    local originalAreFriendsFamily = FamilyHelper.are_friends_family
    local originalIsMyFriendOrFamily = FamilyHelper.is_my_friend_or_family
    local originalAreFamilyBecauseFriends = FamilyHelper.are_family_because_friends
    local originalIsMyFamilyBecauseFriend = FamilyHelper.is_my_family_because_friend
    
    FamilyHelper.are_friends_family = function(player1, player2, ...)
        local userId1 = player1.UserId
        local userId2 = player2.UserId
        return originalAreFriendsFamily(player1, player2)
    end
    
    FamilyHelper.is_my_friend_or_family = function(player, ...)
        local userId = player.UserId
        return originalIsMyFriendOrFamily(player)
    end
    
    FamilyHelper.are_family_because_friends = function(player1, player2, ...)
        local userId1 = player1.UserId
        local userId2 = player2.UserId
        return originalAreFamilyBecauseFriends(player1, player2)
    end
    
    FamilyHelper.is_my_family_because_friend = function(player, ...)
        local userId = player.UserId
        return originalIsMyFamilyBecauseFriend(player)
    end
end)

-- Load required modules
local loadModule = require(ReplicatedStorage:WaitForChild('Fsys')).load
local UIManager = loadModule('UIManager')
local ClientData = loadModule('ClientData')
local TableUtil = loadModule('TableUtil')
local RouterClient = loadModule('RouterClient')
local InventoryDB = loadModule('InventoryDB')
local AnimationManager = loadModule('AnimationManager')
local ColorThemeManager = loadModule('ColorThemeManager')

local waitForInitialization = UIManager.wait_for_initialization
waitForInitialization(UIManager)

-- Get references to various apps
local TradeApp = UIManager.apps.TradeApp
local BackpackApp = UIManager.apps.BackpackApp
local DialogApp = UIManager.apps.DialogApp
local HintApp = UIManager.apps.HintApp
local SettingsApp = UIManager.apps.SettingsApp
local PlayerProfileApp = UIManager.apps.PlayerProfileApp
local TradeHistoryApp = UIManager.apps.TradeHistoryApp
local TradePreviewApp = UIManager.apps.TradePreviewApp
local NegotiationFrame = Players.LocalPlayer.PlayerGui.TradeApp.Frame.NegotiationFrame

-- Loop through InventoryDB
for key, value in pairs(InventoryDB) do
    -- Empty loop body
end

-- Store original functions from TradeApp
local originalGetLocalTradeState = TradeApp._get_local_trade_state
local originalOverwriteLocalTradeState = TradeApp._overwrite_local_trade_state
local originalChangeLocalTradeState = TradeApp._change_local_trade_state
local originalGetMyOffer = TradeApp._get_my_offer
local originalGetPartnerOffer = TradeApp._get_partner_offer
local originalGetMyPlayer = TradeApp._get_my_player
local originalGetPartner = TradeApp._get_partner
local originalGetCurrentTradeStage = TradeApp._get_current_trade_stage
local originalOnAcceptPressed = TradeApp._on_accept_pressed
local originalOnConfirmPressed = TradeApp._on_confirm_pressed
local originalOnUnacceptPressed = TradeApp._on_unaccept_pressed
local originalDeclineTrade = TradeApp._decline_trade
local originalAddItemToMyOffer = TradeApp._add_item_to_my_offer
local originalRemoveItemFromMyOffer = TradeApp._remove_item_from_my_offer
local originalLockTradeForAppropriateTime = TradeApp._lock_trade_for_appropriate_time
local originalGetLockTime = TradeApp._get_lock_time
local originalRefreshAll = TradeApp.refresh_all
local originalEvaluateTradeFairness = TradeApp._evaluate_trade_fairness
local originalShowScamVictimWarning = TradeApp._show_scam_victim_warning
local originalShowScamPerpetratorWarning = TradeApp._show_scam_perpetrator_warning

-- Store original functions from TradeHistoryApp
local originalGetTradeHistory = TradeHistoryApp._get_trade_history
local originalReportScam = TradeHistoryApp.report_scam

-- Override TradeHistoryApp._get_trade_history
TradeHistoryApp._get_trade_history = function(self, ...)
    local history = originalGetTradeHistory(self, ...)
    
    for index, trade in ipairs(history) do
        local tradeId = trade.trade_id
        local tradeId2 = trade.trade_id
        -- Process trade IDs
    end
    
    self.cached_trade_history = {[1] = trade}
    return {[1] = trade}
end

-- Override TradeHistoryApp.report_scam
TradeHistoryApp.report_scam = function(self, tradeData, ...)
    local tradeId = tradeData.trade_id
    
    -- Check if trade ID contains 'MOCK_'
    string.find(tostring(tradeId), 'MOCK_')
    
    local setAppVisibility = self.UIManager.set_app_visibility
    setAppVisibility(self.ClassName, false)
    
    self.UIManager.apps.DialogApp:dialog({
        max_length = 500,
        right = 'Report',
        dialog_type = 'ReportScamDialog',
        placeholder_text = 'What happened? (Optional)',
        use_utf8_length = true,
        left = 'Cancel',
        suspect_name = 'SurenArmen',
    })
    
    setAppVisibility(self.ClassName, true)
    
    local isFrameVisible = self.instance.Frame.Visible
    local refresh = self._refresh
    refresh(self)
end

-- Override TradeApp functions
TradeApp._get_local_trade_state = function(self)
    return originalGetLocalTradeState(self)
end

TradeApp._overwrite_local_trade_state = function(self, ...)
    return originalOverwriteLocalTradeState(self, ...)
end

TradeApp._get_my_offer = function(self, ...)
    local getLocalTradeState = self._get_local_trade_state
    getLocalTradeState(self)
    return originalGetMyOffer(self)
end

TradeApp._get_partner_offer = function(self, ...)
    local getLocalTradeState = self._get_local_trade_state
    getLocalTradeState(self)
    return originalGetPartnerOffer(self)
end

TradeApp._get_my_player = function(self)
    return originalGetMyPlayer(self)
end

TradeApp._get_partner = function(self, ...)
    return originalGetPartner(self)
end

TradeApp._get_current_trade_stage = function(self, ...)
    return originalGetCurrentTradeStage(self)
end

TradeApp._change_local_trade_state = function(self, ...)
    return originalChangeLocalTradeState(self, ...)
end

TradeApp._get_lock_time = function(self)
    return originalGetLockTime(self)
end

TradeApp._lock_trade_for_appropriate_time = function(self, ...)
    return originalLockTradeForAppropriateTime(self)
end

TradeApp._add_item_to_my_offer = function(self, ...)
    return originalAddItemToMyOffer(self)
end

TradeApp._remove_item_from_my_offer = function(self, ...)
    return originalRemoveItemFromMyOffer(self, ...)
end

TradeApp._on_accept_pressed = function(self, ...)
    return originalOnAcceptPressed(self)
end

TradeApp._on_confirm_pressed = function(self, ...)
    return originalOnConfirmPressed(self)
end

TradeApp._on_unaccept_pressed = function(self, ...)
    return originalOnUnacceptPressed(self)
end

TradeApp._decline_trade = function(self, ...)
    return originalDeclineTrade(self, ...)
end

TradeApp._evaluate_trade_fairness = function(self, ...)
    return originalEvaluateTradeFairness(self)
end

-- Override DialogApp.dialog
local originalDialog = DialogApp.dialog
DialogApp.dialog = function(self, options, ...)
    local text = options.text
    string.find(options.text, 'has expired!')
    return 'Okay'
end

-- Disable trade request connections
local tradeEvent = loadModule('RouterClient').get_event('TradeAPI/TradeRequestReceived')
local connections = getconnections(tradeEvent.OnClientEvent)

for _, connection in pairs(connections) do
    connection:Disable()
end

-- Reconnect trade event
tradeEvent.OnClientEvent:Connect(function(...)
    for _, connection in pairs(connections) do
        local func = connection.Function
        func(...)
    end
end)

-- Placeholder functions
fenv.showBlockedTradeRequests = function(...) end

-- Override partner profile button callback
local partnerProfileButton = TradeApp.partner_profile_button
local partnerCallbacks = partnerProfileButton.callbacks
local originalMouseButton1Click = partnerCallbacks.mouse_button1_click

partnerCallbacks.mouse_button1_click = function(...)
    originalMouseButton1Click()
end

fenv.updatePartnerFromUsername = function(username, ...)
    Players:GetUserIdFromNameAsync(username)
    return true
end

-- Create GUI
local screenGui = Instance.new('ScreenGui')
screenGui.Name = 'MockTradeControl'
screenGui.ResetOnSpawn = false
screenGui.DisplayOrder = 10
screenGui.Enabled = true
screenGui.Parent = Players.LocalPlayer:WaitForChild('PlayerGui')

local mainFrame = Instance.new('Frame')
mainFrame.Size = UDim2.new(0, 180, 0, 550)
mainFrame.Position = UDim2.new(0, 10, 0, 10)
mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
mainFrame.BorderSizePixel = 0
mainFrame.ZIndex = 1
mainFrame.Parent = screenGui

local mainCorner = Instance.new('UICorner')
mainCorner.CornerRadius = UDim.new(0, 6)
mainCorner.Parent = mainFrame

local mainStroke = Instance.new('UIStroke')
mainStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
mainStroke.Color = Color3.fromRGB(100, 100, 255)
mainStroke.Thickness = 1.5
mainStroke.Parent = mainFrame

local titleLabel = Instance.new('TextLabel')
titleLabel.Size = UDim2.new(1, 0, 0, 18)
titleLabel.Position = UDim2.new(0, 0, 0, 2)
titleLabel.BackgroundTransparency = 1
titleLabel.Text = 'leaked by zen'
titleLabel.Font = Enum.Font.FredokaOne
titleLabel.TextSize = 10
titleLabel.TextColor3 = Color3.fromRGB(240, 240, 255)
titleLabel.Parent = mainFrame

local titleStroke = Instance.new('UIStroke')
titleStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Contextual
titleStroke.Color = Color3.new(0, 0, 0)
titleStroke.Thickness = 0.8
titleStroke.Parent = titleLabel

local tabContainer = Instance.new('Frame')
tabContainer.Size = UDim2.new(0.94, 0, 0, 22)
tabContainer.Position = UDim2.new(0.03, 0, 0, 22)
tabContainer.BackgroundTransparency = 1
tabContainer.Parent = mainFrame

fenv.setActiveTab = function(...) end

-- Control Tab Button
local controlTab = Instance.new('TextButton')
controlTab.Size = UDim2.new(0.23, 0, 1, 0)
controlTab.Position = UDim2.new(0, 0, 0, 0)
controlTab.BackgroundColor3 = Color3.fromRGB(50, 50, 60)
controlTab.BackgroundTransparency = 0.2
controlTab.Text = 'üéÆ Control'
controlTab.Font = Enum.Font.FredokaOne
controlTab.TextSize = 8
controlTab.TextColor3 = Color3.fromRGB(255, 255, 255)
controlTab.Parent = tabContainer

local controlCorner = Instance.new('UICorner')
controlCorner.CornerRadius = UDim.new(0, 4)
controlCorner.Parent = controlTab

local controlStroke = Instance.new('UIStroke')
controlStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
controlStroke.Color = Color3.fromRGB(100, 100, 255)
controlStroke.Thickness = 1.2
controlStroke.Transparency = 0.3
controlStroke.Parent = controlTab

local controlContent = Instance.new('Frame')
controlContent.Size = UDim2.new(0.9, 0, 0, 275)
controlContent.Position = UDim2.new(0.05, 0, 0, 48)
controlContent.BackgroundTransparency = 1
controlContent.Visible = true
controlContent.Parent = mainFrame

-- Control tab click handler
controlTab.MouseButton1Click:Connect(function()
    local tween1 = TweenService:Create(controlTab, TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
        BackgroundColor3 = Color3.fromRGB(50, 50, 60),
    })
    tween1:Play()
    
    local activeColor = Color3.fromRGB(100, 100, 255)
    local tween2 = TweenService:Create(controlStroke, TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
        Color = activeColor,
        Thickness = 1.2,
    })
    tween2:Play()
    
    local pulseTween = TweenService:Create(controlStroke, TweenInfo.new(1.5, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true), {
        Color = activeColor:Lerp(Color3.fromRGB(255, 255, 255), 0.25),
        Thickness = 1.5,
    })
    pulseTween:Play()
    
    controlContent.Visible = true
end)

-- Players Tab Button
local playersTab = Instance.new('TextButton')
playersTab.Size = UDim2.new(0.23, 0, 1, 0)
playersTab.Position = UDim2.new(0.25, 0, 0, 0)
playersTab.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
playersTab.BackgroundTransparency = 0.2
playersTab.Text = 'üë• Players'
playersTab.Font = Enum.Font.FredokaOne
playersTab.TextSize = 8
playersTab.TextColor3 = Color3.fromRGB(255, 255, 255)
playersTab.Parent = tabContainer

local playersCorner = Instance.new('UICorner')
playersCorner.CornerRadius = UDim.new(0, 4)
playersCorner.Parent = playersTab

local playersStroke = Instance.new('UIStroke')
playersStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
playersStroke.Color = Color3.fromRGB(80, 80, 80)
playersStroke.Thickness = 0.8
playersStroke.Transparency = 0.3
playersStroke.Parent = playersTab

local playersContent = Instance.new('Frame')
playersContent.Size = UDim2.new(0.9, 0, 0, 275)
playersContent.Position = UDim2.new(0.05, 0, 0, 48)
playersContent.BackgroundTransparency = 1
playersContent.Visible = false
playersContent.Parent = mainFrame

-- Players tab click handler
playersTab.MouseButton1Click:Connect(function()
    -- Cancel previous pulse tween
    pulseTween:Cancel()
    
    local tween1 = TweenService:Create(playersTab, TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
        BackgroundColor3 = Color3.fromRGB(50, 50, 60),
    })
    tween1:Play()
    
    local playersActiveColor = Color3.fromRGB(100, 100, 255)
    local tween2 = TweenService:Create(playersStroke, TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
        Color = playersActiveColor,
        Thickness = 1.2,
    })
    tween2:Play()
    
    local playersPulseTween = TweenService:Create(playersStroke, TweenInfo.new(1.5, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true), {
        Color = playersActiveColor:Lerp(Color3.fromRGB(255, 255, 255), 0.25),
        Thickness = 1.5,
    })
    playersPulseTween:Play()
    
    local tween3 = TweenService:Create(controlTab, TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
        BackgroundColor3 = Color3.fromRGB(40, 40, 50),
    })
    tween3:Play()
    
    local tween4 = TweenService:Create(controlStroke, TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
        Color = Color3.fromRGB(80, 80, 80),
        Thickness = 0.8,
    })
    tween4:Play()
    
    playersContent.Visible = true
    controlContent.Visible = false
    
    local animateFunc = fenv.animatePlayerList
    error('line 1: attempt to call a nil value')
end)

-- Pets Tab Button
local petsTab = Instance.new('TextButton')
petsTab.Size = UDim2.new(0.23, 0, 1, 0)
petsTab.Position = UDim2.new(0.5, 0, 0, 0)
petsTab.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
petsTab.BackgroundTransparency = 0.2
petsTab.Text = 'üêæ Pets'
petsTab.Font = Enum.Font.FredokaOne
petsTab.TextSize = 8
petsTab.TextColor3 = Color3.fromRGB(255, 255, 255)
petsTab.Parent = tabContainer

local petsCorner = Instance.new('UICorner')
petsCorner.CornerRadius = UDim.new(0, 4)
petsCorner.Parent = petsTab

local petsStroke = Instance.new('UIStroke')
petsStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
petsStroke.Color = Color3.fromRGB(80, 80, 80)
petsStroke.Thickness = 0.8
petsStroke.Transparency = 0.3
petsStroke.Parent = petsTab

local petsContent = Instance.new('Frame')
petsContent.Size = UDim2.new(0.9, 0, 0, 275)
petsContent.Position = UDim2.new(0.05, 0, 0, 48)
petsContent.BackgroundTransparency = 1
petsContent.Visible = false
petsContent.Parent = mainFrame

-- Pets tab click handler
petsTab.MouseButton1Click:Connect(function()
    playersPulseTween:Cancel()
    
    local tween1 = TweenService:Create(playersTab, TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
        BackgroundColor3 = Color3.fromRGB(40, 40, 50),
    })
    tween1:Play()
    
    local tween2 = TweenService:Create(playersStroke, TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
        Color = Color3.fromRGB(80, 80, 80),
        Thickness = 0.8,
    })
    tween2:Play()
    
    local tween3 = TweenService:Create(petsTab, TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
        BackgroundColor3 = Color3.fromRGB(50, 50, 60),
    })
    tween3:Play()
    
    local petsActiveColor = Color3.fromRGB(100, 100, 255)
    local tween4 = TweenService:Create(petsStroke, TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
        Color = petsActiveColor,
        Thickness = 1.2,
    })
    tween4:Play()
    
    local petsPulseTween = TweenService:Create(petsStroke, TweenInfo.new(1.5, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true), {
        Color = petsActiveColor:Lerp(Color3.fromRGB(255, 255, 255), 0.25),
        Thickness = 1.5,
    })
    petsPulseTween:Play()
    
    local tween5 = TweenService:Create(controlTab, TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
        BackgroundColor3 = Color3.fromRGB(40, 40, 50),
    })
    tween5:Play()
    
    local tween6 = TweenService:Create(controlStroke, TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
        Color = Color3.fromRGB(80, 80, 80),
        Thickness = 0.8,
    })
    tween6:Play()
    
    playersContent.Visible = false
    petsContent.Visible = true
    controlContent.Visible = false
    
    error('line 1: attempt to call a nil value')
end)

-- Users Tab Button
local usersTab = Instance.new('TextButton')
usersTab.Size = UDim2.new(0.23, 0, 1, 0)
usersTab.Position = UDim2.new(0.75, 0, 0, 0)
usersTab.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
usersTab.BackgroundTransparency = 0.2
usersTab.Text = 'üßë Users'
usersTab.Font = Enum.Font.FredokaOne
usersTab.TextSize = 8
usersTab.TextColor3 = Color3.fromRGB(255, 255, 255)
usersTab.Parent = tabContainer

local usersCorner = Instance.new('UICorner')
usersCorner.CornerRadius = UDim.new(0, 4)
usersCorner.Parent = usersTab

local usersStroke = Instance.new('UIStroke')
usersStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
usersStroke.Color = Color3.fromRGB(80, 80, 80)
usersStroke.Thickness = 0.8
usersStroke.Transparency = 0.3
usersStroke.Parent = usersTab

local usersContent = Instance.new('Frame')
usersContent.Size = UDim2.new(0.9, 0, 0, 275)
usersContent.Position = UDim2.new(0.05, 0, 0, 48)
usersContent.BackgroundTransparency = 1
usersContent.Visible = false
usersContent.Parent = mainFrame

-- Users tab click handler
usersTab.MouseButton1Click:Connect(function()
    petsPulseTween:Cancel()
    
    local tween1 = TweenService:Create(playersTab, TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
        BackgroundColor3 = Color3.fromRGB(40, 40, 50),
    })
    tween1:Play()
    
    local tween2 = TweenService:Create(playersStroke, TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
        Color = Color3.fromRGB(80, 80, 80),
        Thickness = 0.8,
    })
    tween2:Play()
    
    local tween3 = TweenService:Create(petsTab, TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
        BackgroundColor3 = Color3.fromRGB(40, 40, 50),
    })
    tween3:Play()
    
    local tween4 = TweenService:Create(petsStroke, TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
        Color = Color3.fromRGB(80, 80, 80),
        Thickness = 0.8,
    })
    tween4:Play()
    
    local tween5 = TweenService:Create(usersTab, TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
        BackgroundColor3 = Color3.fromRGB(50, 50, 60),
    })
    tween5:Play()
    
    local usersActiveColor = Color3.fromRGB(100, 100, 255)
    local tween6 = TweenService:Create(usersStroke, TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
        Color = usersActiveColor,
        Thickness = 1.2,
    })
    tween6:Play()
    
    local usersPulseTween = TweenService:Create(usersStroke, TweenInfo.new(1.5, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true), {
        Color = usersActiveColor:Lerp(Color3.fromRGB(255, 255, 255), 0.25),
        Thickness = 1.5,
    })
    usersPulseTween:Play()
    
    local tween7 = TweenService:Create(controlTab, TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
        BackgroundColor3 = Color3.fromRGB(40, 40, 50),
    })
    tween7:Play()
    
    local tween8 = TweenService:Create(controlStroke, TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
        Color = Color3.fromRGB(80, 80, 80),
        Thickness = 0.8,
    })
    tween8:Play()
    
    playersContent.Visible = false
    petsContent.Visible = false
    usersContent.Visible = true
    controlContent.Visible = false
    
    local animateFunc = fenv.animateUserList
    error('line 1: attempt to call a nil value')
end)

-- Layout for control content
local controlLayout = Instance.new('UIListLayout')
controlLayout.SortOrder = Enum.SortOrder.LayoutOrder
controlLayout.Padding = UDim.new(0, 3)
controlLayout.Parent = controlContent

-- Function to create setting rows
fenv.createSettingRow = function(label, value, parent)
    local labelElement = Instance.new('TextLabel')
    labelElement.Size = UDim2.new(1, 0, 0, 12)
    labelElement.BackgroundTransparency = 1
    labelElement.Text = label
    labelElement.Font = Enum.Font.SourceSansSemibold
    labelElement.TextSize = 9
    labelElement.TextColor3 = Color3.fromRGB(180, 180, 180)
    labelElement.TextXAlignment = Enum.TextXAlignment.Left
    labelElement.Parent = parent
    
    local textBox = Instance.new('TextBox')
    textBox.Size = UDim2.new(1, 0, 0, 20)
    textBox.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
    textBox.BackgroundTransparency = 0.2
    textBox.Text = tostring(value)
    textBox.Font = Enum.Font.SourceSans
    textBox.TextSize = 11
    textBox.TextColor3 = Color3.fromRGB(255, 255, 255)
    textBox.ClearTextOnFocus = false
    textBox.TextXAlignment = Enum.TextXAlignment.Center
    textBox.Parent = parent
    
    local textBoxCorner = Instance.new('UICorner')
    textBoxCorner.CornerRadius = UDim.new(0, 4)
    textBoxCorner.Parent = textBox
    
    local textBoxStroke = Instance.new('UIStroke')
    textBoxStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    textBoxStroke.Color = Color3.fromRGB(100, 100, 100)
    textBoxStroke.Thickness = 0.8
    textBoxStroke.Transparency = 0.5
    textBoxStroke.Parent = textBox
    
    textBox.Focused:Connect(function()
        local focusColor = Color3.fromRGB(100, 100, 255)
        local focusTween = TweenService:Create(textBoxStroke, TweenInfo.new(0.8, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true), {
            Color = focusColor:Lerp(Color3.fromRGB(150, 150, 255), 0.5),
            Transparency = 0.2,
            Thickness = 1.2,
        })
        focusTween:Play()
    end)
    
    textBox.FocusLost:Connect(function()
        focusTween:Cancel()
        local lostTween = TweenService:Create(textBoxStroke, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {
            Color = Color3.fromRGB(100, 100, 100),
            Transparency = 0.5,
            Thickness = 0.8,
        })
        lostTween:Play()
    end)
    
    return textBox, textBoxStroke, labelElement
end

-- Partner Username input
local partnerLabel = Instance.new('TextLabel')
partnerLabel.Size = UDim2.new(1, 0, 0, 12)
partnerLabel.BackgroundTransparency = 1
partnerLabel.Text = 'Partner Username'
partnerLabel.Font = Enum.Font.SourceSansSemibold
partnerLabel.TextSize = 9
partnerLabel.TextColor3 = Color3.fromRGB(180, 180, 180)
partnerLabel.TextXAlignment = Enum.TextXAlignment.Left
partnerLabel.Parent = controlContent

local partnerInput = Instance.new('TextBox')
partnerInput.Size = UDim2.new(1, 0, 0, 20)
partnerInput.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
partnerInput.BackgroundTransparency = 0.2
partnerInput.Text = tostring(username)
partnerInput.Font = Enum.Font.SourceSans
partnerInput.TextSize = 11
partnerInput.TextColor3 = Color3.fromRGB(255, 255, 255)
partnerInput.ClearTextOnFocus = false
partnerInput.TextXAlignment = Enum.TextXAlignment.Center
partnerInput.Parent = controlContent

local partnerCorner = Instance.new('UICorner')
partnerCorner.CornerRadius = UDim.new(0, 4)
partnerCorner.Parent = partnerInput

local partnerStroke = Instance.new('UIStroke')
partnerStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
partnerStroke.Color = Color3.fromRGB(100, 100, 100)
partnerStroke.Thickness = 0.8
partnerStroke.Transparency = 0.5
partnerStroke.Parent = partnerInput

partnerInput.Focused:Connect(function()
    local focusColor = Color3.fromRGB(100, 100, 255)
    local focusTween = TweenService:Create(partnerStroke, TweenInfo.new(0.8, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true), {
        Color = focusColor:Lerp(Color3.fromRGB(150, 150, 255), 0.5),
        Transparency = 0.2,
        Thickness = 1.2,
    })
    focusTween:Play()
end)

partnerInput.FocusLost:Connect(function()
    focusTween:Cancel()
    local lostTween = TweenService:Create(partnerStroke, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {
        Color = Color3.fromRGB(100, 100, 100),
        Transparency = 0.5,
        Thickness = 0.8,
    })
    lostTween:Play()
end)

-- Accept Delay input
local acceptDelayLabel = Instance.new('TextLabel')
acceptDelayLabel.Size = UDim2.new(1, 0, 0, 12)
acceptDelayLabel.BackgroundTransparency = 1
acceptDelayLabel.Text = 'Accept Delay (s)'
acceptDelayLabel.Font = Enum.Font.SourceSansSemibold
acceptDelayLabel.TextSize = 9
acceptDelayLabel.TextColor3 = Color3.fromRGB(180, 180, 180)
acceptDelayLabel.TextXAlignment = Enum.TextXAlignment.Left
acceptDelayLabel.Parent = controlContent

local acceptDelayInput = Instance.new('TextBox')
acceptDelayInput.Size = UDim2.new(1, 0, 0, 20)
acceptDelayInput.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
acceptDelayInput.BackgroundTransparency = 0.2
acceptDelayInput.Text = '0.5'
acceptDelayInput.Font = Enum.Font.SourceSans
acceptDelayInput.TextSize = 11
acceptDelayInput.TextColor3 = Color3.fromRGB(255, 255, 255)
acceptDelayInput.ClearTextOnFocus = false
acceptDelayInput.TextXAlignment = Enum.TextXAlignment.Center
acceptDelayInput.Parent = controlContent

local acceptDelayCorner = Instance.new('UICorner')
acceptDelayCorner.CornerRadius = UDim.new(0, 4)
acceptDelayCorner.Parent = acceptDelayInput

local acceptDelayStroke = Instance.new('UIStroke')
acceptDelayStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
acceptDelayStroke.Color = Color3.fromRGB(100, 100, 100)
acceptDelayStroke.Thickness = 0.8
acceptDelayStroke.Transparency = 0.5
acceptDelayStroke.Parent = acceptDelayInput

acceptDelayInput.Focused:Connect(function()
    local focusColor = Color3.fromRGB(100, 100, 255)
    local focusTween = TweenService:Create(acceptDelayStroke, TweenInfo.new(0.8, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true), {
        Color = focusColor:Lerp(Color3.fromRGB(150, 150, 255), 0.5),
        Transparency = 0.2,
        Thickness = 1.2,
    })
    focusTween:Play()
end)

acceptDelayInput.FocusLost:Connect(function()
    focusTween:Cancel()
    local lostTween = TweenService:Create(acceptDelayStroke, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {
        Color = Color3.fromRGB(100, 100, 100),
        Transparency = 0.5,
        Thickness = 0.8,
    })
    lostTween:Play()
end)

-- Confirm Delay input
local confirmDelayLabel = Instance.new('TextLabel')
confirmDelayLabel.Size = UDim2.new(1, 0, 0, 12)
confirmDelayLabel.BackgroundTransparency = 1
confirmDelayLabel.Text = 'Confirm Delay (s)'
confirmDelayLabel.Font = Enum.Font.SourceSansSemibold
confirmDelayLabel.TextSize = 9
confirmDelayLabel.TextColor3 = Color3.fromRGB(180, 180, 180)
confirmDelayLabel.TextXAlignment = Enum.TextXAlignment.Left
confirmDelayLabel.Parent = controlContent

local confirmDelayInput = Instance.new('TextBox')
confirmDelayInput.Size = UDim2.new(1, 0, 0, 20)
confirmDelayInput.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
confirmDelayInput.BackgroundTransparency = 0.2
confirmDelayInput.Text = '0.3'
confirmDelayInput.Font = Enum.Font.SourceSans
confirmDelayInput.TextSize = 11
confirmDelayInput.TextColor3 = Color3.fromRGB(255, 255, 255)
confirmDelayInput.ClearTextOnFocus = false
confirmDelayInput.TextXAlignment = Enum.TextXAlignment.Center
confirmDelayInput.Parent = controlContent

local confirmDelayCorner = Instance.new('UICorner')
confirmDelayCorner.CornerRadius = UDim.new(0, 4)
confirmDelayCorner.Parent = confirmDelayInput

local confirmDelayStroke = Instance.new('UIStroke')
confirmDelayStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
confirmDelayStroke.Color = Color3.fromRGB(100, 100, 100)
confirmDelayStroke.Thickness = 0.8
confirmDelayStroke.Transparency = 0.5
confirmDelayStroke.Parent = confirmDelayInput

confirmDelayInput.Focused:Connect(function()
    local focusColor = Color3.fromRGB(100, 100, 255)
    local focusTween = TweenService:Create(confirmDelayStroke, TweenInfo.new(0.8, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true), {
        Color = focusColor:Lerp(Color3.fromRGB(150, 150, 255), 0.5),
        Transparency = 0.2,
        Thickness = 1.2,
    })
    focusTween:Play()
end)

confirmDelayInput.FocusLost:Connect(function()
    focusTween:Cancel()
    local lostTween = TweenService:Create(confirmDelayStroke, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {
        Color = Color3.fromRGB(100, 100, 100),
        Transparency = 0.5,
        Thickness = 0.8,
    })
    lostTween:Play()
end)

-- Spectator Count input
local spectatorLabel = Instance.new('TextLabel')
spectatorLabel.Size = UDim2.new(1, 0, 0, 12)
spectatorLabel.BackgroundTransparency = 1
spectatorLabel.Text = 'Spectator Count'
spectatorLabel.Font = Enum.Font.SourceSansSemibold
spectatorLabel.TextSize = 9
spectatorLabel.TextColor3 = Color3.fromRGB(180, 180, 180)
spectatorLabel.TextXAlignment = Enum.TextXAlignment.Left
spectatorLabel.Parent = controlContent

local spectatorInput = Instance.new('TextBox')
spectatorInput.Size = UDim2.new(1, 0, 0, 20)
spectatorInput.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
spectatorInput.BackgroundTransparency = 0.2
spectatorInput.Text = '0'
spectatorInput.Font = Enum.Font.SourceSans
spectatorInput.TextSize = 11
spectatorInput.TextColor3 = Color3.fromRGB(255, 255, 255)
spectatorInput.ClearTextOnFocus = false
spectatorInput.TextXAlignment = Enum.TextXAlignment.Center
spectatorInput.Parent = controlContent

local spectatorCorner = Instance.new('UICorner')
spectatorCorner.CornerRadius = UDim.new(0, 4)
spectatorCorner.Parent = spectatorInput

local spectatorStroke = Instance.new('UIStroke')
spectatorStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
spectatorStroke.Color = Color3.fromRGB(100, 100, 100)
spectatorStroke.Thickness = 0.8
spectatorStroke.Transparency = 0.5
spectatorStroke.Parent = spectatorInput

spectatorInput.Focused:Connect(function()
    local focusColor = Color3.fromRGB(100, 100, 255)
    local focusTween = TweenService:Create(spectatorStroke, TweenInfo.new(0.8, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true), {
        Color = focusColor:Lerp(Color3.fromRGB(150, 150, 255), 0.5),
        Transparency = 0.2,
        Thickness = 1.2,
    })
    focusTween:Play()
end)

spectatorInput.FocusLost:Connect(function()
    focusTween:Cancel()
    local lostTween = TweenService:Create(spectatorStroke, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {
        Color = Color3.fromRGB(100, 100, 100),
        Transparency = 0.5,
        Thickness = 0.8,
    })
    lostTween:Play()
end)

-- Request Delay input
local requestDelayLabel = Instance.new('TextLabel')
requestDelayLabel.Size = UDim2.new(1, 0, 0, 12)
requestDelayLabel.BackgroundTransparency = 1
requestDelayLabel.Text = 'Request Delay (s)'
requestDelayLabel.Font = Enum.Font.SourceSansSemibold
requestDelayLabel.TextSize = 9
requestDelayLabel.TextColor3 = Color3.fromRGB(180, 180, 180)
requestDelayLabel.TextXAlignment = Enum.TextXAlignment.Left
requestDelayLabel.Parent = controlContent

local requestDelayInput = Instance.new('TextBox')
requestDelayInput.Size = UDim2.new(1, 0, 0, 20)
requestDelayInput.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
requestDelayInput.BackgroundTransparency = 0.2
requestDelayInput.Text = '1'
requestDelayInput.Font = Enum.Font.SourceSans
requestDelayInput.TextSize = 11
requestDelayInput.TextColor3 = Color3.fromRGB(255, 255, 255)
requestDelayInput.ClearTextOnFocus = false
requestDelayInput.TextXAlignment = Enum.TextXAlignment.Center
requestDelayInput.Parent = controlContent

local requestDelayCorner = Instance.new('UICorner')
requestDelayCorner.CornerRadius = UDim.new(0, 4)
requestDelayCorner.Parent = requestDelayInput

local requestDelayStroke = Instance.new('UIStroke')
requestDelayStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
requestDelayStroke.Color = Color3.fromRGB(100, 100, 100)
requestDelayStroke.Thickness = 0.8
requestDelayStroke.Transparency = 0.5
requestDelayStroke.Parent = requestDelayInput

requestDelayInput.Focused:Connect(function()
    local focusColor = Color3.fromRGB(100, 100, 255)
    local focusTween = TweenService:Create(requestDelayStroke, TweenInfo.new(0.8, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut, -1, true), {
        Color = focusColor:Lerp(Color3.fromRGB(150, 150, 255), 0.5),
        Transparency = 0.2,
        Thickness = 1.2,
    })
    focusTween:Play()
end)

requestDelayInput.FocusLost:Connect(function()
    focusTween:Cancel()
    local lostTween = TweenService:Create(requestDelayStroke, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {
        Color = Color3.fromRGB(100, 100, 100),
        Transparency = 0.5,
        Thickness = 0.8,
    })
    lostTween:Play()
end)

-- Open Profile function
fenv.OpenProfile = function(userId)
    local PlayerProfileApp = loadModule('UIManager').apps.PlayerProfileApp
    local openProfileFunction = PlayerProfileApp.open_player_profile_for_user_id
    openProfileFunction(PlayerProfileApp, userId)
end

-- Override InteractionsEngine
task.spawn(function()
    task.wait(0.1)
    
    local InteractionsEngine = loadModule('InteractionsEngine')
    local originalRegister = InteractionsEngine.register
    
    InteractionsEngine.register = function(interaction, data, ...)
        local part = data.part
        
        -- Check for fake pet attribute recursively
        if part:GetAttribute('IsFakePet') then
            -- Skip if it's a fake pet
            return
        end
        
        local parent1 = part.Parent
        if parent1:GetAttribute('IsFakePet') then return end
        
        local parent2 = parent1.Parent
        if parent2:GetAttribute('IsFakePet') then return end
        
        local parent3 = parent2.Parent
        if parent3:GetAttribute('IsFakePet') then return end
        
        local parent4 = parent3.Parent
        if parent4:GetAttribute('IsFakePet') then return end
        
        local parent5 = parent4.Parent
        if parent5:GetAttribute('IsFakePet') then return end
        
        local parent6 = parent5.Parent
        if parent6:GetAttribute('IsFakePet') then return end
        
        local parent7 = parent6.Parent
        if parent7:GetAttribute('IsFakePet') then return end
        
        local parent8 = parent7.Parent
        if parent8:GetAttribute('IsFakePet') then return end
        
        local parent9 = parent8.Parent
        if parent9:GetAttribute('IsFakePet') then return end
        
        local parent10 = parent9.Parent
        if parent10:GetAttribute('IsFakePet') then return end
        
        local parent11 = parent10.Parent
        if parent11:GetAttribute('IsFakePet') then return end
        
        local parent12 = parent11.Parent
        if parent12:GetAttribute('IsFakePet') then return end
        
        local parent13 = parent12.Parent
        if parent13:GetAttribute('IsFakePet') then return end
        
        local parent14 = parent13.Parent
        if parent14:GetAttribute('IsFakePet') then return end
        
        local parent15 = parent14.Parent
        if parent15:GetAttribute('IsFakePet') then return end
        
        local parent16 = parent15.Parent
        if parent16:GetAttribute('IsFakePet') then return end
        
        local parent17 = parent16.Parent
        if parent17:GetAttribute('IsFakePet') then return end
        
        local parent18 = parent17.Parent
        if parent18:GetAttribute('IsFakePet') then return end
        
        local getAttributeFunc = parent18.Parent.GetAttribute
        
        error('internal 551: <25ms: infinitelooperror>')
    end
end)

-- Create fake player character function
fenv.CreateFakePlayerCharacterFromPARTNER_NAME = function(username, userId, petData, ...)
    local fakeFolder = Instance.new('Folder')
    fakeFolder.Name = 'fake_folder_' .. username
    fakeFolder.Parent = workspace
    
    local playerModel = Players:CreateHumanoidModelFromUserId(userId)
    playerModel:SetPrimaryPartCFrame((Players.LocalPlayer.Character.HumanoidRootPart.CFrame * CFrame.new(7, 0, 5)))
    
    local humanoid = playerModel:WaitForChild('Humanoid')
    humanoid.DisplayDistanceType = Enum.HumanoidDisplayDistanceType.None
    humanoid.HealthDisplayType = Enum.HumanoidHealthDisplayType.AlwaysOff
    humanoid.HealthDisplayDistance = 0
    playerModel.Parent = fakeFolder
    
    local petKind = petData.kind
    local promiseDownloadCopy = loadModule('DownloadClient').promise_download_copy
    local petModel = promiseDownloadCopy('Pets', petKind):expect():Clone():Clone()
    
    petModel:SetAttribute('IsFakePet', true)
    
    local isMega = petData.M
    local petModelChild = petModel:FindFirstChild('PetModel')
    local petInfo = InventoryDB.pets[petKind]
    local neonParts = petInfo.neon_parts
    
    for partName, partInfo in pairs(neonParts) do
        local getGeoPart = loadModule('new:PetRigs').get(petModelChild).get_geo_part
        local geoPart = getGeoPart(petModelChild, partName)
        
        geoPart.Material = Enum.Material.Neon
        
        local h, s, v = partInfo.Color:ToHSV()
        local colorFromHSV = Color3.fromHSV
        
        warn('Error creating fake pet (Attempt 1/3):', [[[string "sandbox"]:1: attempt to perform arithmetic (mul) on nil and number]])
        fakeFolder:Destroy()
        
        local retryMessage = username .. '...'
        print('üîÑ Retrying fake character creation for ' .. retryMessage)
        task.wait(0.5)
        
        local fakeFolder2 = Instance.new('Folder')
        fakeFolder2.Name = 'fake_folder_' .. username
        fakeFolder2.Parent = workspace
        
        local playerModel2 = Players:CreateHumanoidModelFromUserId(userId)
        playerModel2:SetPrimaryPartCFrame((Players.LocalPlayer.Character.HumanoidRootPart.CFrame * CFrame.new(-5, 0, -7)))
        
        local humanoid2 = playerModel2:WaitForChild('Humanoid')
        humanoid2.DisplayDistanceType = Enum.HumanoidDisplayDistanceType.None
        humanoid2.HealthDisplayType = Enum.HumanoidHealthDisplayType.AlwaysOff
        humanoid2.HealthDisplayDistance = 0
        playerModel2.Parent = fakeFolder2
        
        local petKind2 = petData.kind
        
        warn('Failed to download pet model for:', petKind2)
        warn('Could not get pet model for kind:', petKind2)
        warn('Error creating fake pet (Attempt 2/3):', nil)
        fakeFolder2:Destroy()
        
        local retryMessage2 = username .. '...'
        print('üîÑ Retrying fake character creation for ' .. retryMessage2)
        task.wait(0.5)
        
        local fakeFolder3 = Instance.new('Folder')
        fakeFolder3.Name = 'fake_folder_' .. username
        fakeFolder3.Parent = workspace
        
        local playerModel3 = Players:CreateHumanoidModelFromUserId(userId)
        playerModel3:SetPrimaryPartCFrame((Players.LocalPlayer.Character.HumanoidRootPart.CFrame * CFrame.new(8, 0, 3)))
        
        local humanoid3 = playerModel3:WaitForChild('Humanoid')
        humanoid3.DisplayDistanceType = Enum.HumanoidDisplayDistanceType.None
        humanoid3.HealthDisplayType = Enum.HumanoidHealthDisplayType.AlwaysOff
        humanoid3.HealthDisplayDistance = 0
        playerModel3.Parent = fakeFolder3
        
        warn('Error creating fake pet (Attempt 3/3):', '[string "./httplog2"]:551: <25ms: infinitelooperror>')
        fakeFolder3:Destroy()
        warn('‚ùå Failed to create fake character after 3 attempts')
        
        return false
    end
end

fenv.GetKindPet = function(...) end

-- Add Random Item button
local spacer1 = Instance.new('Frame')
spacer1.Size = UDim2.new(1, 0, 0, 4)
spacer1.BackgroundTransparency = 1
spacer1.Parent = controlContent

local addRandomItemButton = Instance.new('TextButton')
addRandomItemButton.Size = UDim2.new(1, 0, 0, 22)
addRandomItemButton.BackgroundColor3 = Color3.fromRGB(100, 50, 150)
addRandomItemButton.BackgroundTransparency = 0.2
addRandomItemButton.Text = 'Add Random Item'
addRandomItemButton.Font = Enum.Font.FredokaOne
addRandomItemButton.TextSize = 10
addRandomItemButton.TextColor3 = Color3.fromRGB(255, 255, 255)
addRandomItemButton.Parent = controlContent

local addRandomItemCorner = Instance.new('UICorner')
addRandomItemCorner.CornerRadius = UDim.new(0, 4)
addRandomItemCorner.Parent = addRandomItemButton

local addRandomItemStroke = Instance.new('UIStroke')
addRandomItemStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
addRandomItemStroke.Color = Color3.fromRGB(200, 100, 255)
addRandomItemStroke.Thickness = 1
addRandomItemStroke.Transparency = 0.3
addRandomItemStroke.Parent = addRandomItemButton

addRandomItemButton.MouseButton1Click:Connect(function(...) end)

-- Clear Trade button
local spacer2 = Instance.new('Frame')
spacer2.Size = UDim2.new(1, 0, 0, 3)
spacer2.BackgroundTransparency = 1
spacer2.Parent = controlContent

local clearTradeButton = Instance.new('TextButton')
clearTradeButton.Size = UDim2.new(1, 0, 0, 22)
clearTradeButton.BackgroundColor3 = Color3.fromRGB(150, 50, 50)
clearTradeButton.BackgroundTransparency = 0.2
clearTradeButton.Text = 'Clear Trade'
clearTradeButton.Font = Enum.Font.FredokaOne
clearTradeButton.TextSize = 10
clearTradeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
clearTradeButton.Parent = controlContent

local clearTradeCorner = Instance.new('UICorner')
clearTradeCorner.CornerRadius = UDim.new(0, 4)
clearTradeCorner.Parent = clearTradeButton

local clearTradeStroke = Instance.new('UIStroke')
clearTradeStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
clearTradeStroke.Color = Color3.fromRGB(255, 100, 100)
clearTradeStroke.Thickness = 1
clearTradeStroke.Transparency = 0.3
clearTradeStroke.Parent = clearTradeButton

clearTradeButton.MouseButton1Click:Connect(function(...) end)

-- Start Trade button
local spacer3 = Instance.new('Frame')
spacer3.Size = UDim2.new(1, 0, 0, 3)
spacer3.BackgroundTransparency = 1
spacer3.Parent = controlContent

local startTradeButton = Instance.new('TextButton')
startTradeButton.Size = UDim2.new(1, 0, 0, 22)
startTradeButton.BackgroundColor3 = Color3.fromRGB(50, 80, 60)
startTradeButton.BackgroundTransparency = 0.2
startTradeButton.Text = 'Start Trade'
startTradeButton.Font = Enum.Font.FredokaOne
startTradeButton.TextSize = 10
startTradeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
startTradeButton.Parent = controlContent

local startTradeCorner = Instance.new('UICorner')
startTradeCorner.CornerRadius = UDim.new(0, 4)
startTradeCorner.Parent = startTradeButton

local startTradeStroke = Instance.new('UIStroke')
startTradeStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
startTradeStroke.Color = Color3.fromRGB(0, 255, 100)
startTradeStroke.Thickness = 1
startTradeStroke.Transparency = 0.3
startTradeStroke.Parent = startTradeButton

fenv.BlockPlayer = function(...) end

-- Block Player button
local blockPlayerButton = Instance.new('TextButton')
blockPlayerButton.Size = UDim2.new(1, 0, 0, 22)
blockPlayerButton.BackgroundColor3 = Color3.fromRGB(150, 50, 50)
blockPlayerButton.BackgroundTransparency = 0.2
blockPlayerButton.Text = 'Block Player'
blockPlayerButton.Font = Enum.Font.FredokaOne
blockPlayerButton.TextSize = 10
blockPlayerButton.TextColor3 = Color3.fromRGB(255, 255, 255)
blockPlayerButton.Parent = controlContent

local blockPlayerCorner = Instance.new('UICorner')
blockPlayerCorner.CornerRadius = UDim.new(0, 4)
blockPlayerCorner.Parent = blockPlayerButton

local blockPlayerStroke = Instance.new('UIStroke')
blockPlayerStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
blockPlayerStroke.Color = Color3.fromRGB(255, 100, 100)
blockPlayerStroke.Thickness = 1
blockPlayerStroke.Transparency = 0.3
blockPlayerStroke.Parent = blockPlayerButton

blockPlayerButton.MouseButton1Click:Connect(function(...) end)

-- Make Partner Accept button
local spacer4 = Instance.new('Frame')
spacer4.Size = UDim2.new(1, 0, 0, 3)
spacer4.BackgroundTransparency = 1
spacer4.Parent = controlContent

local makeAcceptButton = Instance.new('TextButton')
makeAcceptButton.Size = UDim2.new(1, 0, 0, 22)
makeAcceptButton.BackgroundColor3 = Color3.fromRGB(50, 150, 50)
makeAcceptButton.BackgroundTransparency = 0.2
makeAcceptButton.Text = 'Make Partner Accept'
makeAcceptButton.Font = Enum.Font.FredokaOne
makeAcceptButton.TextSize = 10
makeAcceptButton.TextColor3 = Color3.fromRGB(255, 255, 255)
makeAcceptButton.Parent = controlContent

local makeAcceptCorner = Instance.new('UICorner')
makeAcceptCorner.CornerRadius = UDim.new(0, 4)
makeAcceptCorner.Parent = makeAcceptButton

local makeAcceptStroke = Instance.new('UIStroke')
makeAcceptStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
makeAcceptStroke.Color = Color3.fromRGB(100, 255, 100)
makeAcceptStroke.Thickness = 1
makeAcceptStroke.Transparency = 0.3
makeAcceptStroke.Parent = makeAcceptButton

fenv.makePartnerAccept = function(...) end

-- Toggle Noclip button
local spacer5 = Instance.new('Frame')
spacer5.Size = UDim2.new(1, 0, 0, 3)
spacer5.BackgroundTransparency = 1
spacer5.Parent = controlContent

local toggleNoclipButton = Instance.new('TextButton')
toggleNoclipButton.Size = UDim2.new(1, 0, 0, 22)
toggleNoclipButton.BackgroundColor3 = Color3.fromRGB(80, 80, 180)
toggleNoclipButton.BackgroundTransparency = 0.2
toggleNoclipButton.Text = 'Toggle Noclip: ON'
toggleNoclipButton.Font = Enum.Font.FredokaOne
toggleNoclipButton.TextSize = 10
toggleNoclipButton.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleNoclipButton.Parent = controlContent

local toggleNoclipCorner = Instance.new('UICorner')
toggleNoclipCorner.CornerRadius = UDim.new(0, 4)
toggleNoclipCorner.Parent = toggleNoclipButton

local toggleNoclipStroke = Instance.new('UIStroke')
toggleNoclipStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
toggleNoclipStroke.Color = Color3.fromRGB(100, 100, 255)
toggleNoclipStroke.Thickness = 1
toggleNoclipStroke.Transparency = 0.3
toggleNoclipStroke.Parent = toggleNoclipButton

toggleNoclipButton.MouseButton1Click:Connect(function(...) end)

-- Make Partner Unaccept button
local spacer6 = Instance.new('Frame')
spacer6.Size = UDim2.new(1, 0, 0, 3)
spacer6.BackgroundTransparency = 1
spacer6.Parent = controlContent

local makeUnacceptButton = Instance.new('TextButton')
makeUnacceptButton.Size = UDim2.new(1, 0, 0, 22)
makeUnacceptButton.BackgroundColor3 = Color3.fromRGB(150, 50, 50)
makeUnacceptButton.BackgroundTransparency = 0.2
makeUnacceptButton.Text = 'Make Partner Unaccept'
makeUnacceptButton.Font = Enum.Font.FredokaOne
makeUnacceptButton.TextSize = 10
makeUnacceptButton.TextColor3 = Color3.fromRGB(255, 255, 255)
makeUnacceptButton.Parent = controlContent

local makeUnacceptCorner = Instance.new('UICorner')
makeUnacceptCorner.CornerRadius = UDim.new(0, 4)
makeUnacceptCorner.Parent = makeUnacceptButton

local makeUnacceptStroke = Instance.new('UIStroke')
makeUnacceptStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
makeUnacceptStroke.Color = Color3.fromRGB(255, 100, 100)
makeUnacceptStroke.Thickness = 1
makeUnacceptStroke.Transparency = 0.3
makeUnacceptStroke.Parent = makeUnacceptButton

fenv.makePartnerUnaccept = function(...) end

-- Connect button click handlers
makeUnacceptButton.MouseButton1Click:Connect(function(...) end)
makeAcceptButton.MouseButton1Click:Connect(function(...) end)
print([[Accept Trade button added - Click to make partner accept the trade]])

-- Fake Player Pet selection
local spacer7 = Instance.new('Frame')
spacer7.Size = UDim2.new(1, 0, 0, 3)
spacer7.BackgroundTransparency = 1
spacer7.Parent = controlContent

local petSelectionContainer = Instance.new('Frame')
petSelectionContainer.Size = UDim2.new(1, 0, 0, 20)
petSelectionContainer.BackgroundTransparency = 1
petSelectionContainer.Parent = controlContent

local petSelectionLabel = Instance.new('TextLabel')
petSelectionLabel.Size = UDim2.new(0.4, 0, 1, 0)
petSelectionLabel.BackgroundTransparency = 1
petSelectionLabel.Text = 'Fake Player Pet:'
petSelectionLabel.Font = Enum.Font.SourceSansSemibold
petSelectionLabel.TextSize = 9
petSelectionLabel.TextColor3 = Color3.fromRGB(180, 180, 180)
petSelectionLabel.TextXAlignment = Enum.TextXAlignment.Left
petSelectionLabel.Parent = petSelectionContainer

local regularPetButton = Instance.new('TextButton')
regularPetButton.Size = UDim2.new(0.18, 0, 1, 0)
regularPetButton.Position = UDim2.new(0.4, 0, 0, 0)
regularPetButton.Text = 'Reg'
regularPetButton.BackgroundColor3 = Color3.fromRGB(50, 150, 50)
regularPetButton.Font = Enum.Font.FredokaOne
regularPetButton.TextSize = 8
regularPetButton.TextColor3 = Color3.fromRGB(255, 255, 255)
regularPetButton.Parent = petSelectionContainer

local neonPetButton = Instance.new('TextButton')
neonPetButton.Size = UDim2.new(0.18, 0, 1, 0)
neonPetButton.Position = UDim2.new(0.6, 0, 0, 0)
neonPetButton.Text = 'Neon'
regularPetButton.BackgroundColor3 = Color3.fromRGB(50, 150, 50)
neonPetButton.BackgroundColor3 = Color3.fromRGB(60, 60, 70)
neonPetButton.Font = Enum.Font.FredokaOne
neonPetButton.TextSize = 8
neonPetButton.TextColor3 = Color3.fromRGB(255, 255, 255)
neonPetButton.Parent = petSelectionContainer

local megaPetButton = Instance.new('TextButton')
megaPetButton.Size = UDim2.new(0.18, 0, 1, 0)
megaPetButton.Position = UDim2.new(0.8, 0, 0, 0)
megaPetButton.Text = 'Mega'
megaPetButton.BackgroundColor3 = Color3.fromRGB(60, 60, 70)
megaPetButton.Font = Enum.Font.FredokaOne
megaPetButton.TextSize = 8
megaPetButton.TextColor3 = Color3.fromRGB(255, 255, 255)
megaPetButton.Parent = petSelectionContainer

regularPetButton.MouseButton1Click:Connect(function(...) end)
neonPetButton.MouseButton1Click:Connect(function(...) end)
megaPetButton.MouseButton1Click:Connect(function(...) end)

-- Spawn fake player button
local spawnFakePlayerButton = Instance.new('TextButton')
spawnFakePlayerButton.Size = UDim2.new(1, 0, 0, 22)
spawnFakePlayerButton.BackgroundColor3 = Color3.fromRGB(65, 50, 150)
spawnFakePlayerButton.BackgroundTransparency = 0.2
spawnFakePlayerButton.Text = 'Spawn fake player'
spawnFakePlayerButton.Font = Enum.Font.FredokaOne
spawnFakePlayerButton.TextSize = 10
spawnFakePlayerButton.TextColor3 = Color3.fromRGB(255, 255, 255)
spawnFakePlayerButton.Parent = controlContent

local spawnFakePlayerCorner = Instance.new('UICorner')
spawnFakePlayerCorner.CornerRadius = UDim.new(0, 4)
spawnFakePlayerCorner.Parent = spawnFakePlayerButton

local spawnFakePlayerStroke = Instance.new('UIStroke')
spawnFakePlayerStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
spawnFakePlayerStroke.Color = Color3.fromRGB(74, 207, 255)
spawnFakePlayerStroke.Thickness = 1
spawnFakePlayerStroke.Transparency = 0.3
spawnFakePlayerStroke.Parent = spawnFakePlayerButton

spawnFakePlayerButton.MouseButton1Click:Connect(function(...) end)

-- Spawn with random pet toggle
local spacer8 = Instance.new('Frame')
spacer8.Size = UDim2.new(1, 0, 0, 3)
spacer8.BackgroundTransparency = 1
spacer8.Parent = controlContent

local randomPetToggle = Instance.new('TextButton')
randomPetToggle.Size = UDim2.new(1, 0, 0, 12)
randomPetToggle.BackgroundColor3 = Color3.fromRGB(150, 50, 50)
randomPetToggle.BackgroundTransparency = 0.2
randomPetToggle.Text = 'Spawn with random pet: false'
randomPetToggle.Font = Enum.Font.FredokaOne
randomPetToggle.TextSize = 6
randomPetToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
randomPetToggle.Parent = controlContent

local randomPetCorner = Instance.new('UICorner')
randomPetCorner.CornerRadius = UDim.new(0, 3)
randomPetCorner.Parent = randomPetToggle

local randomPetStroke = Instance.new('UIStroke')
randomPetStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
randomPetStroke.Color = Color3.fromRGB(255, 100, 100)
randomPetStroke.Thickness = 0.8
randomPetStroke.Transparency = 0.3
randomPetStroke.Parent = randomPetToggle

randomPetToggle.MouseButton1Click:Connect(function() end)

-- Delete all fake players button
local spacer9 = Instance.new('Frame')
spacer9.Size = UDim2.new(1, 0, 0, 3)
spacer9.BackgroundTransparency = 1
spacer9.Parent = controlContent

local deleteAllFakeButton = Instance.new('TextButton')
deleteAllFakeButton.Size = UDim2.new(1, 0, 0, 12)
deleteAllFakeButton.BackgroundColor3 = Color3.fromRGB(157, 58, 0)
deleteAllFakeButton.BackgroundTransparency = 0.2
deleteAllFakeButton.Text = 'Delete all fake players'
deleteAllFakeButton.Font = Enum.Font.FredokaOne
deleteAllFakeButton.TextSize = 6
deleteAllFakeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
deleteAllFakeButton.Parent = controlContent

local deleteAllCorner = Instance.new('UICorner')
deleteAllCorner.CornerRadius = UDim.new(0, 3)
deleteAllCorner.Parent = deleteAllFakeButton

local deleteAllStroke = Instance.new('UIStroke')
deleteAllStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
deleteAllStroke.Color = Color3.fromRGB(255, 0, 0)
deleteAllStroke.Thickness = 0.8
deleteAllStroke.Transparency = 0.3
deleteAllStroke.Parent = deleteAllFakeButton

-- Connect various event handlers
deleteAllFakeButton.MouseButton1Click:Connect(function(...) end)
startTradeButton.MouseButton1Click:Connect(function(...) end)
partnerInput.FocusLost:Connect(function(...) end)
acceptDelayInput.FocusLost:Connect(function(...) end)
confirmDelayInput.FocusLost:Connect(function(...) end)
spectatorInput.FocusLost:Connect(function() end)
requestDelayInput.FocusLost:Connect(function(...) end)

-- Create players list scrolling frame
local playersScrollingFrame = Instance.new('ScrollingFrame')
playersScrollingFrame.Size = UDim2.new(1, 0, 1, 0)
playersScrollingFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
playersScrollingFrame.BackgroundTransparency = 0.5
playersScrollingFrame.BorderSizePixel = 0
playersScrollingFrame.ScrollBarThickness = 4
playersScrollingFrame.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 100)
playersScrollingFrame.ScrollBarImageTransparency = 0.5
playersScrollingFrame.Parent = playersContent

local playersScrollingCorner = Instance.new('UICorner')
playersScrollingCorner.CornerRadius = UDim.new(0, 4)
playersScrollingCorner.Parent = playersScrollingFrame

local playersListLayout = Instance.new('UIListLayout')
playersListLayout.SortOrder = Enum.SortOrder.LayoutOrder
playersListLayout.Padding = UDim.new(0, 3)
playersListLayout.Parent = playersScrollingFrame

local playersListPadding = Instance.new('UIPadding')
playersListPadding.PaddingTop = UDim.new(0, 4)
playersListPadding.PaddingBottom = UDim.new(0, 4)
playersListPadding.PaddingLeft = UDim.new(0, 4)
playersListPadding.PaddingRight = UDim.new(0, 4)
playersListPadding.Parent = playersScrollingFrame

fenv.createPlayerButton = function(...) end
fenv.createSelectPlayerFromTradeButton = function(...) end

-- Select from trade button
local selectFromTradeButton = Instance.new('TextButton')
selectFromTradeButton.Size = UDim2.new(1, -8, 0, 28)
selectFromTradeButton.BackgroundColor3 = Color3.fromRGB(65, 65, 81)
selectFromTradeButton.BackgroundTransparency = 0.2
selectFromTradeButton.Name = 'SelectFromTradeButton'
selectFromTradeButton.Text = ''
selectFromTradeButton.Parent = playersScrollingFrame

local selectFromTradeCorner = Instance.new('UICorner')
selectFromTradeCorner.CornerRadius = UDim.new(0, 4)
selectFromTradeCorner.Parent = selectFromTradeButton

local selectFromTradeStroke = Instance.new('UIStroke')
selectFromTradeStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
selectFromTradeStroke.Color = Color3.fromRGB(159, 159, 159)
selectFromTradeStroke.Thickness = 1
selectFromTradeStroke.Transparency = 0.3
selectFromTradeStroke.Parent = selectFromTradeButton

local selectFromTradeLabel = Instance.new('TextLabel')
selectFromTradeLabel.Size = UDim2.new(1, -8, 1, 0)
selectFromTradeLabel.Position = UDim2.new(0, 4, 0, 0)
selectFromTradeLabel.BackgroundTransparency = 1
selectFromTradeLabel.Text = 'Select Partner From Trade'
selectFromTradeLabel.Font = Enum.Font.FredokaOne
selectFromTradeLabel.TextSize = 11
selectFromTradeLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
selectFromTradeLabel.TextXAlignment = Enum.TextXAlignment.Left
selectFromTradeLabel.TextTransparency = 0
selectFromTradeLabel.Parent = selectFromTradeButton

local selectFromTradeLabelStroke = Instance.new('UIStroke')
selectFromTradeLabelStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Contextual
selectFromTradeLabelStroke.Color = Color3.new(0, 0, 0)
selectFromTradeLabelStroke.Thickness = 0.8
selectFromTradeLabelStroke.Transparency = 0.8
selectFromTradeLabelStroke.Parent = selectFromTradeLabel

selectFromTradeButton.MouseButton1Click:Connect(function(...) end)

selectFromTradeButton.LayoutOrder = -999

fenv.animatePlayerList = function(...) end
fenv.refreshPlayerList = function(...) end

-- Clear existing player buttons
for _, child in ipairs(playersScrollingFrame:GetChildren()) do
    if child:IsA('TextButton') then
        local childName = child.Name
        child:Destroy()
    end
end

-- Create player buttons
local allPlayers = Players:GetPlayers()

table.sort(allPlayers, function(player1, player2) end)

for _, player in ipairs(allPlayers) do
    local playerButton = Instance.new('TextButton')
    playerButton.Size = UDim2.new(1, -8, 0, 28)
    playerButton.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
    playerButton.BackgroundTransparency = 0.2
    playerButton.Text = ''
    playerButton.Parent = playersScrollingFrame
    
    Instance.new('UICorner')
    error('internal 551: <25ms: infinitelooperror>')
end
